title: "Application Database"
rows:
  - title: "Overview"
    panels:
      - title: "Database Metrics"
        type: markdown
        content: |
          Database connection pool and query performance metrics from the application.
          Monitors connection utilization, query latency, and throughput by operation type.
        span: 12

  - title: "Connection Pool"
    panels:
      - title: "Active Connections"
        type: graph
        query: 'myapp_db_connections_active'
        unit: count
        y_min: 0
      - title: "Idle Connections"
        type: graph
        query: 'myapp_db_connections_idle'
        unit: count
        y_min: 0

  - title: "Query Duration"
    panels:
      - title: "Query Duration p99 by Operation"
        type: graph
        query: 'histogram_quantile(0.99, sum by (le, operation)(rate(myapp_db_query_duration_seconds_bucket[5m])))'
        unit: seconds
        legend: "{operation}"
        y_min: 0
      - title: "Query Duration p95 by Operation"
        type: graph
        query: 'histogram_quantile(0.95, sum by (le, operation)(rate(myapp_db_query_duration_seconds_bucket[5m])))'
        unit: seconds
        legend: "{operation}"
        y_min: 0

  - title: "Query Throughput"
    panels:
      - title: "Query Rate by Operation"
        type: graph
        query: 'sum by (operation)(rate(myapp_db_query_duration_seconds_count[5m]))'
        unit: count
        chart_type: bar
        legend: "{operation}"
        y_min: 0
      - title: "Average Query Duration by Operation"
        type: graph
        query: 'sum by (operation)(rate(myapp_db_query_duration_seconds_sum[5m])) / (sum by (operation)(rate(myapp_db_query_duration_seconds_count[5m])) > 0)'
        unit: seconds
        legend: "{operation}"
        y_min: 0
