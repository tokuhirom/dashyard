title: "Redis"
rows:
  - title: "Overview"
    panels:
      - title: "Redis"
        type: markdown
        content: |
          Redis server metrics from the Redis exporter.
          Monitors memory, commands, connections, keyspace hit ratio, and CPU usage.
        span: 12

  - title: "Memory"
    panels:
      - title: "Memory Usage"
        type: graph
        query: 'redis_memory_used_bytes'
        unit: bytes
        y_min: 0
      - title: "Peak Memory"
        type: graph
        query: 'redis_memory_peak_bytes'
        unit: bytes
        y_min: 0
      - title: "Memory Fragmentation Ratio"
        type: graph
        query: 'redis_memory_fragmentation_ratio'
        unit: count
        y_min: 0
        thresholds:
          - value: 1.5
            color: "#f59e0b"
            label: "High Fragmentation"

  - title: "Commands & Throughput"
    panels:
      - title: "Commands per Second"
        type: graph
        query: 'redis_commands_per_second'
        unit: count
        chart_type: bar
        y_min: 0
      - title: "Total Commands Processed Rate"
        type: graph
        query: 'rate(redis_commands_processed_total[5m])'
        unit: count
        chart_type: bar
        y_min: 0

  - title: "Connections"
    panels:
      - title: "Connected Clients"
        type: graph
        query: 'redis_clients_connected'
        unit: count
        y_min: 0
      - title: "Blocked Clients"
        type: graph
        query: 'redis_clients_blocked'
        unit: count
        y_min: 0
      - title: "New Connections Rate"
        type: graph
        query: 'rate(redis_connections_received_total[5m])'
        unit: count
        chart_type: bar
        y_min: 0

  - title: "Connection Errors"
    panels:
      - title: "Rejected Connections Rate"
        type: graph
        query: 'rate(redis_connections_rejected_total[5m])'
        unit: count
        chart_type: bar
        y_min: 0

  - title: "Keyspace"
    panels:
      - title: "Keyspace Hits Rate"
        type: graph
        query: 'rate(redis_keyspace_hits_total[5m])'
        unit: count
        chart_type: bar
        y_min: 0
      - title: "Keyspace Misses Rate"
        type: graph
        query: 'rate(redis_keyspace_misses_total[5m])'
        unit: count
        chart_type: bar
        y_min: 0
      - title: "Keyspace Hit Ratio"
        type: graph
        query: 'rate(redis_keyspace_hits_total[5m]) / (rate(redis_keyspace_hits_total[5m]) + rate(redis_keyspace_misses_total[5m]) > 0) * 100'
        unit: percent
        y_min: 0
        y_max: 100
        thresholds:
          - value: 90
            color: "#22c55e"
            label: "Good (90%)"

  - title: "Keys"
    panels:
      - title: "Evicted Keys Rate"
        type: graph
        query: 'rate(redis_keys_evicted_total[5m])'
        unit: count
        chart_type: bar
        y_min: 0
      - title: "Expired Keys Rate"
        type: graph
        query: 'rate(redis_keys_expired_total[5m])'
        unit: count
        chart_type: bar
        y_min: 0

  - title: "CPU"
    panels:
      - title: "Redis CPU Time Rate"
        type: graph
        query: 'rate(redis_cpu_time_seconds_total[5m])'
        unit: seconds
        chart_type: area
        stacked: true
        legend: "{state}"
        y_min: 0
        legend_position: right
        legend_max_width: 150

  - title: "Network"
    panels:
      - title: "Network Input Rate"
        type: graph
        query: 'rate(redis_net_input_bytes_total[5m])'
        unit: bytes
        y_min: 0
      - title: "Network Output Rate"
        type: graph
        query: 'rate(redis_net_output_bytes_total[5m])'
        unit: bytes
        y_min: 0

  - title: "Persistence & Replication"
    panels:
      - title: "RDB Changes Since Last Save"
        type: graph
        query: 'redis_rdb_changes_since_last_save'
        unit: count
        y_min: 0
      - title: "Connected Slaves"
        type: graph
        query: 'redis_slaves_connected'
        unit: count
        y_min: 0
      - title: "Lua Memory"
        type: graph
        query: 'redis_memory_lua_bytes'
        unit: bytes
        y_min: 0
